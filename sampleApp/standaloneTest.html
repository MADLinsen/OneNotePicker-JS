<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.0/vue.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vuex/2.3.1/vuex.js"></script>
	<link href="../dist/oneNotePicker.css" rel="stylesheet">
	<script src="../dist/oneNotePickerComponent.js"></script>
	<script src="../dist/data.js"></script>
</head>
<body>
<div id="oneNotePicker">
	<onenote-picker :notebooks="notebooks"></onenote-picker>
</div>
<script>
	let data = {
	    notebooks: []
	};

	let store = new Vuex.Store();

	Vue.use(OneNotePickerPlugin, store);

	let oneNotePicker = new Vue({
		el: "#oneNotePicker",
		store: store,
		data,
	});

	let dataSource = new OneNotePickerDataSource("Amazing");

	dataSource.getNotebooks({"MS-Int-AppId": "OneNote Test"}).then((value) => {
		console.log(value);
		data.notebooks = value;

		Vue.set(data, 'notebooks', value);
	}).catch((value) => {
		console.error(value);
	});


</script>
</body>
</html>
